import {
  Meta,
  Story,
  ArgsTable,
  Canvas,
  Description,
} from '@storybook/addon-docs';
import { action } from '@storybook/addon-actions';
import ScaleNotification from './ScaleNotification.vue';

<!-- TODO events -->

<Meta
  title="Beta Components/Notification"
  component={ScaleNotification}
  argTypes={{
    heading: {
      control: {
        type: 'text',
      },
    },
    type: {
      options: ['inline', 'banner', 'toast'],
      control: {
        type: 'select',
      },
    },
    variant: {
      options: ['informational', 'warning', 'success', 'danger'],
      control: {
        type: 'select',
      },
    },
    opened: {
      defaultValue: true,
      control: {
        type: 'boolean'
      }
    },
    dismissible: {
      defaultValue: true,
      control: {
        type: 'boolean'
      }
    },
    delay: {
      control: {
        type: 'number'
      }
    },
    innerAriaLive: {
      control: {
        type: 'text'
      }
    },
    closeButtonLabel: {
      control: {
        type: 'text'
      }
    },
    closeButtonTitle: {
      control: {
        type: 'text'
      }
    },
    'scale-open': {
      description: 'Fires after the notification has been opened',
      table: {
        category: 'Events',
      },
    },
    'scale-before-close': {
      description: 'Fires on every close attempt. Calling `event.preventDefault()` will prevent the modal from closing',
      table: {
        category: 'Events',
      },
    },
    'scale-close': {
      description: 'Fires after the notification has been closed',
      table: {
        category: 'Events',
      },
    }
  }}
/>

<div
  style={{
    display: 'inline-flex',
    alignItems: 'center',
    justifyContent: 'space-between',
    width: '100%',
  }}
>
  <h1>Notification</h1>
  <img src="assets/beta.png" alt="Beta Component" />
</div>

## Standard

<Canvas withSource="none">
  <Story
    name="Standard"
    args={{
      heading: 'Notification heading goes here'
    }}
  >
    {{
      props: {
        ...ScaleNotification.props,
      },
      template: `
        <div>
          <scale-notification
            :heading="heading"
            :type="type"
            :variant="variant"
            :opened="opened"
            :dismissible="dismissible"
            :delay="delay"
            :inner-aria-live="innerAriaLive"
            :close-button-label="closeButtonLabel"
            :close-button-title="closeButtonTitle"
            @scale-open="emitOpen"
            @scale-before-close="emitBeforeClose"
            @scale-close="emitClose"
          ></scale-notification>
        </div>
      `,
      methods: {
        emitOpen: action('scale-open'),
        emitBeforeClose: action('scale-before-close'),
        emitClose: action('scale-close'),
      }
    }}
  </Story>
</Canvas>

<ArgsTable story="Standard" />

```html
<scale-notification heading="Notification text goes here" opened></scale-notification>
```

### Scoped CSS variables

```css
:host {
  --width: 100%;
  --radius: var(--telekom-radius-standard);
  --spacing-y: var(--telekom-spacing-unit-x4);
  --spacing-y-inner: var(--telekom-spacing-unit-x2);
  --spacing-x-aside: var(--telekom-spacing-unit-x12);
  --spacing-outer-toast: var(--telekom-spacing-unit-x4);
}
```

## Types

### Inline (default)

<Canvas withSource="none">
  <Story name="Inline">
    {{
      template: `
        <div>
          <scale-notification
            heading="Notification heading goes here"
            opened
          ></scale-notification>
        </div>
      `
    }}
  </Story>
</Canvas>

```html
<scale-notification heading="Notification text goes here" opened></scale-notification>
```

### Banner

<Canvas withSource="none">
  <Story name="Banner">
    {{
      data() {
        return {
          isOpen: false,
        }
      },
      template: `
        <div>
          <scale-button variant="secondary" @click="isOpen = true">Show</scale-button>
          <div style="margin-top: 1rem">
            <scale-notification
              heading="Notification heading goes here"
              type="banner"
              variant="success"
              :opened="isOpen"
              delay="3000"
              @scale-open="emitOpen"
              @scale-before-close="emitBeforeClose"
              @scale-close="close"
            ></scale-notification>
          </div>
        </div>
      `,
      methods: {
        close() {
          this.isOpen = false;
          this.emitClose();
        },
        emitOpen: action('scale-open'),
        emitBeforeClose: action('scale-before-close'),
        emitClose: action('scale-close'),
      }
    }}
  </Story>
</Canvas>

```html
<scale-notification
  heading="Notification text goes here"
  type="banner"
  variant="success"
  delay="3000"
>
</scale-notification>
```

### Toast

<Canvas withSource="none">
  <Story name="Toast">
    {{
      data() {
        return {
          count: 1,
          variants: ['informational', 'warning', 'success', 'danger'],
          currentVariant: 0,
        }
      },
      template: `
        <div>
          <div ref="stack" class="scl-toast-stack"></div>
          <scale-button variant="secondary" @click="create">Show</scale-button>
        </div>
      `,
      methods: {
        create() {
          const toast = Object.assign(
            document.createElement('scale-notification'),
            {
              heading: `Notification toast #${this.count++}`, 
              type: 'toast',
              variant: this.variants[this.currentVariant],
              delay: 5000,
              dismissible: true,
              opened: false,
              // is this safe?
              innerHTML: '<span slot="text">Additional text goes in the `text` slot</span>'
            }
          );
          const handleBeforeClose = (event) => {
            console.log(event.detail);
            this.emitBeforeClose();
            toast.removeEventListener('scale-before-close', handleBeforeClose);
          }
          const handleClose = () => {
            this.emitClose();
            toast.removeEventListener('scale-close', handleClose);
          }
          toast.addEventListener('scale-open', () => this.emitOpen());
          toast.addEventListener('scale-before-close', handleBeforeClose);
          toast.addEventListener('scale-close', handleClose);
          this.$refs.stack.appendChild(toast);
          toast.opened = true;
          this.currentVariant = (this.currentVariant + 1) % this.variants.length;
        },
        emitOpen: action('scale-open'),
        emitClose: action('scale-close'),
        emitBeforeClose: action('scale-before-close'),
      }
    }}
  </Story>
</Canvas>

In order to "toast" a notification, append it to a div with the `.scl-toast-stack` class. Listen to the `scale-close` event if you'd like to remove them from the DOM after being dismissed.

```html
<div class="scl-toast-stack">
  <scale-notification
    heading="Notification toast #1"
    type="toast"
    dismissible
    delay="5000"
    opened
  >
    <span slot="text">Additional text goes in the `text` slot</span>
  </scale-notification>
</div>
```

## Variants

### Informational (default)

<Canvas withSource="none">
  <Story name="Informational">
    {{
      template: `
        <div>
          <scale-notification
            heading="Notification heading goes here"
            variant="informational"
            opened
          ></scale-notification>
        </div>
      `
    }}
  </Story>
</Canvas>

```html
<scale-notification
  heading="Notification text goes here"
  variant="informational"
  opened
></scale-notification>
```

### Warning

<Canvas withSource="none">
  <Story name="Warning">
    {{
      template: `
        <div>
          <scale-notification
            heading="Notification heading goes here"
            variant="warning"
            opened
          ></scale-notification>
        </div>
      `
    }}
  </Story>
</Canvas>

```html
<scale-notification
  heading="Notification text goes here"
  variant="warning"
  opened
></scale-notification>
```

### Success

<Canvas withSource="none">
  <Story name="Success">
    {{
      template: `
        <div>
          <scale-notification
            heading="Notification heading goes here"
            variant="success"
            opened
          ></scale-notification>
        </div>
      `
    }}
  </Story>
</Canvas>

```html
<scale-notification
  heading="Notification text goes here"
  variant="success"
  opened
></scale-notification>
```

### Danger

<Canvas withSource="none">
  <Story name="Danger">
    {{
      template: `
        <div>
          <scale-notification
            heading="Notification heading goes here"
            variant="danger"
            opened
          ></scale-notification>
        </div>
      `
    }}
  </Story>
</Canvas>

```html
<scale-notification
  heading="Notification text goes here"
  variant="danger"
  opened
></scale-notification>
```

## Text Slot

<Canvas withSource="none">
  <Story name="Text Slot">
    {{
      template: `
        <div>
          <scale-notification
            heading="Notification heading goes here"
            opened
          >
            <span slot="text">Additional text</span>
          </scale-notification>
        </div>
      `
    }}
  </Story>
</Canvas>

```html
<scale-notification heading="Notification text goes here" opened>
  <span slot="text">Additional text</span>
</scale-notification>
```
